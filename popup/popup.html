<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forge Wallet</title>
    <link rel="stylesheet" href="../styles/main.css">
    <script src="theme-loader.js"></script>
</head>
<body>
    <!-- Loader Screen -->
    <div id="loaderContainer" class="loader-container">
        <div class="loader-content">
            <div class="loader-logo">
                <img src="../assets/forge-logo.svg" alt="Forge" style="width: 64px; height: 64px;">
            </div>
            <div class="loader-spinner"></div>
            <div class="loader-text" data-i18n="loading">Loading Forge Wallet...</div>
            <div class="loader-version">v0.0.12</div>
            <div class="loader-progress">
                <div class="loader-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Setup Screen (показується при першому запуску) -->
    <div id="setupScreen" class="screen">
        <div class="wallet-header">
            <div class="wallet-logo">
                <div class="logo-icon">
                    <img src="../assets/forge-logo.svg" alt="Forge" style="width: 48px; height: 48px;">
                </div>
                <div class="logo-text">Forge Wallet</div>
            </div>
        </div>

        <div style="padding: 40px 20px; text-align: center;">
            <h2 style="color: var(--text-primary); font-size: 20px; margin-bottom: 12px;" data-i18n="welcomeTitle">Welcome to Forge Wallet</h2>
            <p style="color: var(--text-muted); margin-bottom: 32px; line-height: 1.5;" data-i18n="welcomeSubtitle">
                Secure Ethereum wallet with multi-chain bridge support
            </p>

            <div style="display: flex; flex-direction: column; gap: 12px; max-width: 280px; margin: 0 auto;">
                <button id="createWalletBtn" class="btn btn-primary" style="width: 100%;" data-i18n="createNewWallet">
                    Create New Wallet
                </button>
                <button id="importWalletBtn" class="btn btn-secondary" style="width: 100%;" data-i18n="importExistingWallet">
                        Import Existing Wallet
                </button>
            </div>
        </div>
    </div>

    <!-- Unlock Screen (показується коли session expired) -->
    <div id="unlockScreen" class="screen" style="display: none;">
        <div class="wallet-header">
            <div class="wallet-logo">
                <div class="logo-icon">
                    <img src="../assets/forge-logo.svg" alt="Forge" style="width: 48px; height: 48px;">
                </div>
                <div class="logo-text">Forge Wallet</div>
            </div>
        </div>

        <div style="padding: 40px 20px; text-align: center;">
            <div id="lockIconContainer" class="lock-icon-container">
                <!-- Locked state -->
                <svg id="lockIconLocked" class="lock-icon lock-icon-locked" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="var(--accent-blue)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
                <!-- Unlocked state -->
                <svg id="lockIconUnlocked" class="lock-icon lock-icon-unlocked" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 5-5 5 5 0 0 1 5 5"></path>
                </svg>
            </div>
            <h2 style="color: var(--text-primary); font-size: 20px; margin-bottom: 8px;" data-i18n="unlockWallet">Unlock Wallet</h2>
            <p style="color: var(--text-muted); margin-bottom: 32px; font-size: 13px;" data-i18n="enterPasswordToContinue">
                Enter your password to continue
            </p>

            <div style="max-width: 280px; margin: 0 auto;">
                <input type="password" id="unlockPassword" data-i18n-placeholder="password" 
                       style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; 
                              background: var(--bg-secondary); color: var(--text-primary); font-size: 14px; margin-bottom: 12px;">
                <button id="unlockBtn" class="btn btn-primary" style="width: 100%;" data-i18n="unlock">
                    Unlock
                </button>
                <div id="unlockError" style="color: var(--error); font-size: 12px; margin-top: 8px; display: none;"></div>
                
                <div style="margin-top: 32px; padding-top: 16px; border-top: 1px solid var(--border-color);">
                    <a href="/cdn-cgi/l/email-protection#097a7c7979667b7d496f667b6e6c246c7d61276066" style="color: var(--text-muted); font-size: 12px; text-decoration: none;">
                        <span data-i18n="needHelp">Need help?</span> <span style="color: var(--accent-blue);" data-i18n="contactSupportLink">Contact Support <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" style="vertical-align: middle;"><path d="M5 12h14M12 5l7 7-7 7"/></svg></span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Transaction Approval Screen -->
    <div id="approvalScreen" class="screen" style="display: none;">
        <div class="wallet-header">
            <div class="wallet-logo">
                <div class="logo-icon">
                    <img src="../assets/forge-logo.svg" alt="Forge" style="width: 48px; height: 48px;">
                </div>
                <div class="logo-text">Forge Wallet</div>
            </div>
        </div>

        <div style="padding: 16px; overflow-y: auto; max-height: 536px;">
            <div style="text-align: center; margin-bottom: 16px;">
                <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">From site</div>
                <div id="approvalSiteName" style="font-size: 14px; color: var(--text-primary); font-weight: 600;">Unknown Site</div>
            </div>

            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                <div style="margin-bottom: 12px;">
                    <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">From</div>
                    <div style="display: flex; align-items: center; gap: 8px; background: var(--bg-input); padding: 8px; border-radius: 4px;">
                        <div style="font-size: 12px; color: var(--text-primary); font-weight: 600;" id="approvalFromName">Account 1</div>
                        <div style="font-size: 10px; color: var(--text-muted); font-family: var(--font-mono);" id="approvalFromAddress">0x0000...0000</div>
                    </div>
                </div>

                <div style="text-align: center; margin: 8px 0;">
                    <div style="width: 32px; height: 32px; background: var(--accent-blue); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 5v14M19 12l-7 7-7-7"/>
                        </svg>
                    </div>
                </div>

                <div style="margin-bottom: 12px;">
                    <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">To</div>
                    <div style="background: var(--bg-input); padding: 8px; border-radius: 4px;">
                        <div style="font-size: 12px; color: var(--text-primary); font-weight: 600;" id="approvalToName">Address</div>
                        <div style="font-size: 10px; color: var(--text-muted); font-family: var(--font-mono);" id="approvalToAddress">0x0000...0000</div>
                    </div>
                </div>

                <div style="text-align: center; padding: 16px 0; border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color);">
                    <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 4px;">Amount</div>
                    <div style="font-size: 24px; color: var(--text-primary); font-weight: 600;" id="approvalAmountETH">0.000000 ETH</div>
                    <div style="font-size: 12px; color: var(--text-muted);" id="approvalAmountUSD">$0.00</div>
                </div>
            </div>

            <div id="approvalSecurityCheck" style="display: none; background: rgba(255, 152, 0, 0.1); border: 1px solid var(--warning); border-radius: 6px; padding: 12px; margin-bottom: 16px;">
                <div style="font-size: 12px; font-weight: 600; color: var(--warning); margin-bottom: 8px;">Security Check</div>
                <div id="approvalSecurityItems"></div>
            </div>

            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                <div style="font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;">Gas Fee</div>
                
                <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                    <div class="gas-option" data-speed="slow" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border-color); border-radius: 6px; padding: 8px; cursor: pointer; text-align: center;">
                        <div style="font-size: 10px; color: var(--text-muted); margin-bottom: 4px;">Slow</div>
                        <div style="font-size: 11px; color: var(--text-primary);" id="gasSlowETH">-</div>
                    </div>
                    <div class="gas-option selected" data-speed="normal" style="flex: 1; background: var(--accent-blue); border: 1px solid var(--accent-blue); border-radius: 6px; padding: 8px; cursor: pointer; text-align: center;">
                        <div style="font-size: 10px; color: white; margin-bottom: 4px;">Normal</div>
                        <div style="font-size: 11px; color: white;" id="gasNormalETH">-</div>
                    </div>
                    <div class="gas-option" data-speed="fast" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border-color); border-radius: 6px; padding: 8px; cursor: pointer; text-align: center;">
                        <div style="font-size: 10px; color: var(--text-muted); margin-bottom: 4px;">Fast</div>
                        <div style="font-size: 11px; color: var(--text-primary);" id="gasFastETH">-</div>
                    </div>
                </div>

                <div id="approvalGasLoading" style="text-align: center; color: var(--text-muted); font-size: 11px; padding: 8px;">Calculating gas...</div>

                <div style="display: flex; justify-content: space-between; font-size: 12px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                    <span style="color: var(--text-muted);">Estimated gas:</span>
                    <span style="color: var(--text-primary);" id="approvalGasUSD">$0.00</span>
                </div>
            </div>

            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <span style="font-size: 12px; font-weight: 600; color: var(--text-primary);">Total</span>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; color: var(--text-primary); font-weight: 600;" id="approvalTotalETH">0.000000 ETH</div>
                        <div style="font-size: 11px; color: var(--text-muted);" id="approvalTotalUSD">$0.00</div>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 8px;">
                <button id="approvalRejectBtn" class="btn btn-secondary" style="flex: 1;">Reject</button>
                <button id="approvalConfirmBtn" class="btn btn-primary" style="flex: 1;">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Main Wallet Screen -->
    <div id="walletScreen" class="screen" style="display: none;">
        <!-- Header -->
        <div class="wallet-header">
            <!-- Network Selector (left) - opens modal -->
            <div class="header-left">
                <div id="networkSelector" class="network-selector-full">
                    <img class="network-icon img-fallback" id="currentNetworkIcon" src="https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png" data-fallback="../assets/token-icons/eth.svg" alt="">
                    <span id="currentNetworkName">Ethereum</span>
                    <span class="dropdown-arrow">▼</span>
                </div>
            </div>
            
            <!-- Icons (right) -->
            <div class="header-right">
                <!-- Account Avatar (compact) -->
                <button id="accountSelectorBtn" class="header-icon-btn" title="Switch Account">
                    <div class="header-account-avatar" id="headerAccountAvatar">A1</div>
                </button>

                <!-- dApp Connection Indicator -->
                <div id="dappIndicator" class="header-icon-btn dapp-indicator" title="No website detected">
                    <img id="dappFavicon" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%236b7280%22%3E%3Cpath%20d%3D%22M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm-1%2017.93c-3.95-.49-7-3.85-7-7.93%200-.62.08-1.21.21-1.79L9%2015v1c0%201.1.9%202%202%202v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55%200%201-.45%201-1V7h2c1.1%200%202-.9%202-2v-.41c2.93%201.19%205%204.06%205%207.41%200%202.08-.8%203.97-2.1%205.39z%22%2F%3E%3C%2Fsvg%3E" alt="" class="dapp-favicon">
                    <span id="dappBadge" class="dapp-badge disconnected" style="display: none;"></span>
                </div>

                <!-- Settings -->
                <button id="settingsBtn" class="header-icon-btn settings-gear-btn" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Balance Section -->
        <div class="balance-section">
            <div id="balanceToggle" style="cursor: pointer;">
                <div class="balance-usd" id="balanceUSD">$0.00</div>
                <div class="balance-amount" id="balanceAmount">0.00 ETH</div>
            </div>
            <div class="balance-actions">
                <button id="sendBtn" class="btn btn-primary" data-i18n="send">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 4px;">
                        <path d="M8 2L8 14M8 2L4 6M8 2L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Send</span>
                </button>
                <button id="receiveBtn" class="btn btn-secondary" data-i18n="receive">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 4px;">
                        <path d="M8 14L8 2M8 14L12 10M8 14L4 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Receive</span>
                </button>
                <button id="buyBtn" class="btn btn-green" data-i18n="buy">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 4px;">
                        <path d="M2 6L8 2L14 6M3 8V13C3 13.5523 3.44772 14 4 14H12C12.5523 14 13 13.5523 13 13V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Buy</span>
                </button>
                <button id="swapBtn" class="btn btn-orange" data-i18n="swap">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 4px;">
                        <path d="M4 6L2 8L4 10M12 6L14 8L12 10M2 8H14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Swap</span>
                </button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="assets" data-i18n="assets">Assets</button>
            <button class="tab" data-tab="activity" data-i18n="activity">Activity</button>
        </div>

        <!-- Assets Tab -->
        <div id="assetsTab" class="tab-content active">
            <div id="tokenList" class="token-list">
                <!-- Tokens will be loaded here -->
            </div>
            <div style="display: flex; gap: 8px; margin: 8px 16px;">
                <button id="importTokensBtn" class="btn btn-secondary" style="flex: 1;" data-i18n="importTokens">
                    Import Tokens
                </button>
                <button id="addTokenBtn" class="btn btn-secondary" style="flex: 1;" data-i18n="addToken">
                    Add Token
                </button>
            </div>
        </div>

        <!-- Activity Tab -->
        <div id="activityTab" class="tab-content">
            <div style="padding: 12px 16px; border-bottom: 1px solid var(--border-color);">
                <span style="font-size: 13px; color: var(--text-muted);" data-i18n="recentActivity">Recent Activity</span>
            </div>
            <div id="transactionList" class="transaction-list">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                            <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                        </svg>
                    </div>
                    <p data-i18n="noTransactions">No transactions yet</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Wallet Modal -->
    <div id="createWalletModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="createNewWallet">Create New Wallet</h2>
                <button class="modal-close" data-modal="createWalletModal">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="createPasswordLabel">Create a strong password (Latin letters, numbers, symbols only)</label>
                    <input type="password" id="createPassword" class="form-control" data-i18n-placeholder="enterPassword">
                </div>
                <div class="form-group">
                    <label data-i18n="confirmPassword">Confirm password</label>
                    <input type="password" id="confirmPassword" class="form-control" data-i18n-placeholder="confirmPassword">
                </div>
                <div style="background: var(--bg-input); padding: 12px; border-radius: 4px; margin-bottom: 16px; font-size: 11px; color: var(--text-muted); line-height: 1.5;" data-i18n="passwordWarning">
                    Password is used to encrypt your wallet. Store it safely - it cannot be recovered.
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="createWalletModal" data-i18n="cancel">Cancel</button>
                <button id="confirmCreateBtn" class="btn btn-primary" data-i18n="createWallet">Create Wallet</button>
            </div>
        </div>
    </div>

    <!-- Seed Phrase Modal -->
    <div id="seedPhraseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin: -16px -16px 16px; padding: 20px; border-radius: 12px 12px 0 0;">
                <h2 style="margin: 0; font-size: 18px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
                    </svg>
                    <span>Your Seed Phrase</span>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
                    </svg>
                </h2>
            </div>
            <div class="modal-body" style="padding: 0 16px 16px;">
                <div style="background: var(--bg-secondary); padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 2px solid var(--border-color);">
                    <div id="seedPhraseDisplay" style="font-family: var(--font-mono); font-size: 12px; color: var(--text-primary); min-height: 80px;">
                        <!-- Seed phrase will be displayed here -->
                    </div>
                </div>
                <div style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.05) 100%); padding: 12px; border-radius: 8px; border: 1px solid rgba(239, 68, 68, 0.3); margin-bottom: 16px;">
                    <div style="color: var(--error); font-size: 12px; font-weight: 600; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                            <line x1="12" y1="9" x2="12" y2="13"></line>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        <span>CRITICAL WARNING</span>
                    </div>
                    <div style="font-size: 11px; color: var(--text-muted); line-height: 1.5;">
                        Write down this seed phrase and store it in a secure location. Never share it with anyone. Anyone with this phrase can access your funds.
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="continueSeedBtn" class="btn btn-primary" style="width: 100%;">I've Written It Down</button>
            </div>
        </div>
    </div>

    <!-- Verify Seed Phrase Modal -->
    <div id="verifySeedModal" class="modal">
        <div class="modal-content">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin: -16px -16px 16px; padding: 20px; border-radius: 12px 12px 0 0;">
                <h2 style="margin: 0; font-size: 18px; font-weight: 600;">✓ Verify Your Seed Phrase</h2>
            </div>
            <div class="modal-body" style="padding: 0 16px 16px;">
                <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 20px; line-height: 1.5;">
                    Select the correct words from your seed phrase to confirm you have saved it.
                </div>
                
                <!-- First Word Verification -->
                <div class="verify-word-section" style="margin-bottom: 24px;">
                    <label style="display: block; margin-bottom: 8px; font-size: 12px; font-weight: 600; color: var(--text-primary);">
                        Select word #<span id="firstWordNumber">1</span>:
                    </label>
                    <div id="firstWordOptions" class="word-options-grid"></div>
                </div>
                
                <!-- Last Word Verification -->
                <div class="verify-word-section">
                    <label style="display: block; margin-bottom: 8px; font-size: 12px; font-weight: 600; color: var(--text-primary);">
                        Select word #<span id="lastWordNumber">12</span>:
                    </label>
                    <div id="lastWordOptions" class="word-options-grid"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="backToSeedBtn" style="flex: 1;">Back</button>
                <button id="finishSetupBtn" class="btn btn-primary" disabled style="flex: 1;">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Import Wallet Modal -->
    <div id="importWalletModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="importWallet">Import Wallet</h2>
                <button class="modal-close" data-modal="importWalletModal">×</button>
            </div>
            <div class="modal-body">
                <div class="tabs" style="margin-bottom: 16px;">
                    <button class="tab active" data-import-tab="seed" data-i18n="seedPhrase">Seed Phrase</button>
                    <button class="tab" data-import-tab="private" data-i18n="privateKey">Private Key</button>
                </div>

                <div id="importSeedTab" class="import-tab-content active">
                    <div class="form-group">
                        <label data-i18n="enterSeedPhrase">Enter your 12-word seed phrase</label>
                        <textarea id="importSeedPhrase" class="form-control" rows="4" placeholder="word1 word2 word3 ..."></textarea>
                    </div>
                </div>

                <div id="importPrivateKeyTab" class="import-tab-content" style="display: none;">
                    <div class="form-group">
                        <label data-i18n="enterPrivateKey">Enter your private key</label>
                        <input type="password" id="importPrivateKey" class="form-control" placeholder="0x...">
                    </div>
                </div>

                <div class="form-group">
                    <label data-i18n="createPassword">Create a password</label>
                    <input type="password" id="importPassword" class="form-control" data-i18n-placeholder="enterPassword">
                </div>
                <div class="form-group">
                    <label data-i18n="confirmPassword">Confirm password</label>
                    <input type="password" id="importConfirmPassword" class="form-control" data-i18n-placeholder="confirmPassword">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="importWalletModal" data-i18n="cancel">Cancel</button>
                <button id="confirmImportBtn" class="btn btn-primary" data-i18n="importWallet">Import Wallet</button>
            </div>
        </div>
    </div>

    <!-- Send Modal -->
    <div id="sendModal" class="modal modal-fullscreen">
        <div class="modal-content modal-fullscreen">
            <!-- Step 1: Enter Details -->
            <div id="sendStep1" style="display: block;">
                <div class="modal-header">
                    <h2 data-i18n="send">Send</h2>
                    <button class="modal-close" data-modal="sendModal">×</button>
                </div>
                <div class="modal-body" style="padding: 16px;">
                    <!-- From Card (Your Asset) -->
                    <div class="swap-card">
                        <div class="swap-card-header">
                            <span class="swap-card-label">You're sending</span>
                            <span class="swap-card-balance" id="sendBalanceDisplay">Balance: 0</span>
                        </div>
                        
                        <!-- Network Row -->
                        <div class="send-network-row">
                            <span class="send-network-label">Network</span>
                            <div class="send-network-display">
                                <img id="sendNetworkIcon" src="" alt="" class="send-network-icon">
                                <span id="sendNetworkName">Ethereum</span>
                            </div>
                        </div>
                        
                        <div class="swap-card-row">
                            <!-- Token Selector -->
                            <div class="swap-token-selector" id="sendTokenSelector">
                                <img id="sendTokenIcon" src="" alt="" class="swap-token-icon">
                                <span id="sendAssetSymbol">ETH</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                    <path d="M6 9l6 6 6-6"/>
                                </svg>
                            </div>
                            
                            <!-- Amount Input -->
                            <div class="swap-amount-input-container">
                                <input type="number" id="sendAmount" class="swap-amount-input" placeholder="0" step="0.000001">
                            </div>
                        </div>
                        
                        <div class="swap-card-footer">
                            <span id="sendAmountEquivalent" class="swap-value">≈ $0.00</span>
                            <div class="swap-available-row">
                                <span id="sendMaxBalance" class="swap-available">0 available</span>
                                <button id="maxBtn" class="swap-max-btn-small" data-i18n="max">Max</button>
                            </div>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <div class="swap-direction">
                        <div class="swap-direction-btn" style="cursor: default;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                <path d="M12 5v14M19 12l-7 7-7-7"/>
                            </svg>
                        </div>
                    </div>

                    <!-- To Card (Recipient) -->
                    <div class="swap-card">
                        <div class="swap-card-header">
                            <span class="swap-card-label">Recipient</span>
                        </div>
                        
                        <div class="send-recipient-input-container">
                            <input type="text" id="sendToAddress" class="send-recipient-input" placeholder="0x... or ENS name">
                        </div>
                        
                        <div id="addressValidation" class="send-address-validation">
                            <div id="addressError" class="send-validation-error" style="display: none;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M15 9l-6 6M9 9l6 6"/>
                                </svg>
                                <span>Invalid address</span>
                            </div>
                            <div id="addressValid" class="send-validation-success" style="display: none;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 6L9 17l-5-5"/>
                                </svg>
                                <span data-i18n="validAddress">Valid address</span>
                            </div>
                        </div>
                    </div>

                    <!-- Amount Error -->
                    <div id="amountError" class="send-error-banner" style="display: none;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                            <path d="M12 9v4M12 17h.01"/>
                        </svg>
                        <span data-i18n="insufficientBalance">Insufficient balance</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="sendModal" data-i18n="cancel">Cancel</button>
                    <button id="continueBtn" class="btn btn-primary" disabled data-i18n="continue">Continue</button>
                </div>
            </div>

            <!-- Step 2: Review -->
            <div id="sendStep2" style="display: none;">
                <div class="modal-header">
                    <button id="backBtn" class="send-back-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2 data-i18n="review">Review</h2>
                    <button class="modal-close" data-modal="sendModal">×</button>
                </div>
                <div class="modal-body" style="padding: 16px;">
                    <!-- Amount Display -->
                    <div class="send-review-amount">
                        <div class="send-review-amount-primary" id="reviewAmount">0.0032 ETH</div>
                        <div class="send-review-amount-secondary" id="reviewAmountUSD">≈ $10.21</div>
                    </div>

                    <!-- Transaction Details -->
                    <div class="send-review-card">
                        <div class="send-review-row">
                            <span class="send-review-label" data-i18n="from">From</span>
                            <span class="send-review-value" id="reviewFrom">Account 1</span>
                        </div>
                        <div class="send-review-row">
                            <span class="send-review-label" data-i18n="to">To</span>
                            <span class="send-review-value send-review-address" id="reviewTo">0xaC48...aeFE</span>
                        </div>
                    </div>

                    <!-- Fee Details -->
                    <div class="send-review-card">
                        <div class="send-review-row">
                            <span class="send-review-label" data-i18n="network">Network</span>
                            <div class="send-review-network">
                                <img id="reviewNetworkIcon" src="" alt="" class="send-review-network-icon">
                                <span id="reviewNetwork">Ethereum</span>
                            </div>
                        </div>
                        <div class="send-review-row">
                            <span class="send-review-label" data-i18n="networkFee">Network fee</span>
                            <div class="send-review-fee">
                                <span id="reviewGasFee">0.00014 ETH</span>
                                <span class="send-review-fee-usd" id="reviewGasFeeUSD">≈ $0.45</span>
                            </div>
                        </div>
                        <div class="send-review-row">
                            <span class="send-review-label" data-i18n="speed">Speed</span>
                            <span class="send-review-value">Market • ~12 sec</span>
                        </div>
                    </div>

                    <!-- Gas Loading -->
                    <div id="gasLoading" class="send-gas-loading" style="display: none;">
                        <div class="loading"></div>
                        <span data-i18n="calculatingGas">Calculating gas fee...</span>
                    </div>

                    <!-- Insufficient Balance Warning -->
                    <div id="insufficientBalance" class="send-error-banner" style="display: none;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                            <path d="M12 9v4M12 17h.01"/>
                        </svg>
                        <span data-i18n="insufficientBalanceGas">Insufficient balance for gas</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="editBtn" data-i18n="edit"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>Edit</button>
                    <button id="confirmSendBtn" class="btn btn-primary" data-i18n="confirm">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Send Token Picker Modal -->
    <div id="sendTokenPickerModal" class="token-picker-modal" style="display: none;">
        <div class="token-picker-modal-content">
            <div class="token-picker-modal-header">
                <h3>Select Token</h3>
                <button class="token-picker-modal-close" id="sendTokenPickerClose">×</button>
            </div>
            <div class="token-picker-modal-search">
                <input type="text" id="sendTokenSearch" placeholder="Search tokens..." class="token-picker-search-input">
            </div>
            <div id="sendTokenPickerList" class="token-picker-token-list" style="flex: 1; overflow-y: auto;">
                <!-- Tokens will be populated here -->
            </div>
        </div>
    </div>

    <!-- Receive Modal -->
    <div id="receiveModal" class="modal modal-fullscreen">
        <div class="modal-content modal-fullscreen">
            <div class="modal-header">
                <h2 data-i18n="receive">Receive</h2>
                <button class="modal-close" data-modal="receiveModal">×</button>
            </div>
            <div class="modal-body" style="padding: 16px;">
                <!-- Network & Token Selection -->
                <div class="receive-card">
                    <div class="receive-card-header">
                        <span class="receive-card-label">Receive on</span>
                    </div>
                    
                    <!-- Network Selector -->
                    <div class="receive-selector" id="receiveNetworkBtn">
                        <div class="receive-selector-left">
                            <img id="receiveNetworkIcon" src="" alt="" class="receive-selector-icon">
                            <span id="receiveNetworkName">Ethereum</span>
                        </div>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 9l6 6 6-6"/>
                        </svg>
                        <input type="hidden" id="receiveNetwork" value="1">
                    </div>
                    
                    <!-- Token Selector -->
                    <div class="receive-card-header" style="margin-top: 16px;">
                        <span class="receive-card-label">Token</span>
                    </div>
                    <div class="receive-selector" id="receiveTokenBtn">
                        <div class="receive-selector-left">
                            <img id="receiveTokenIcon" src="" alt="" class="receive-selector-icon">
                            <div class="receive-selector-info">
                                <span id="receiveTokenSymbol">ETH</span>
                                <span id="receiveTokenName" class="receive-token-name">Ethereum</span>
                            </div>
                        </div>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 9l6 6 6-6"/>
                        </svg>
                        <input type="hidden" id="receiveToken" value="ETH">
                    </div>
                </div>

                <!-- Info Banner -->
                <div class="receive-info-banner">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4M12 8h.01"/>
                    </svg>
                    <span>All tokens on <strong id="receiveNetworkNameInfo">Ethereum</strong> use the same address</span>
                </div>

                <!-- Address -->
                <div class="receive-address-container">
                    <div class="receive-address-label">Your Address</div>
                    <div class="receive-address-box">
                        <span id="receiveAddress" class="receive-address-text"></span>
                        <button id="copyAddressBtn" class="receive-copy-btn" title="Copy">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Show QR Button -->
                <button id="showQrBtn" class="btn btn-secondary" style="width: 100%; margin-top: 16px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                    </svg>
                    Show QR Code
                </button>

                <!-- QR Code (hidden by default) -->
                <div id="qrCodeContainer" class="receive-qr-container" style="display: none;" data-hidden="true">
                    <div id="qrCode" class="receive-qr">
                        <!-- QR Code буде тут -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Receive Network Picker Modal -->
    <div id="receiveNetworkPickerModal" class="token-picker-modal" style="display: none;">
        <div class="token-picker-modal-content">
            <div class="token-picker-modal-header">
                <h3>Select Network</h3>
                <button class="token-picker-modal-close" id="receiveNetworkPickerClose">×</button>
            </div>
            <div id="receiveNetworkPickerList" class="token-picker-token-list" style="padding: 8px;">
                <!-- Networks will be populated here -->
            </div>
        </div>
    </div>

    <!-- Receive Token Picker Modal -->
    <div id="receiveTokenPickerModal" class="token-picker-modal" style="display: none;">
        <div class="token-picker-modal-content">
            <div class="token-picker-modal-header">
                <h3>Select Token</h3>
                <button class="token-picker-modal-close" id="receiveTokenPickerClose">×</button>
            </div>
            <div class="token-picker-modal-section" style="padding: 12px 16px;">
                <div class="receive-same-address-note">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4M12 8h.01"/>
                    </svg>
                    All tokens share the same wallet address
                </div>
            </div>
            <div id="receiveTokenPickerList" class="token-picker-token-list" style="padding: 8px;">
                <!-- Tokens will be populated here -->
            </div>
        </div>
    </div>

    <!-- Bridge Modal -->
    <div id="bridgeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="bridgeAssets">Bridge Assets</h2>
                <button class="modal-close" data-modal="bridgeModal">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="fromNetwork">From Network</label>
                    <select id="bridgeFromNetwork" class="form-control">
                        <option value="1">Ethereum</option>
                        <option value="56">BNB Chain</option>
                        <option value="137">Polygon</option>
                        <option value="42161">Arbitrum</option>
                        <option value="10">Optimism</option>
                        <option value="8453">Base</option>
                        <option value="43114">Avalanche</option>
                    </select>
                </div>
                <div style="text-align: center; margin: 12px 0;">
                    <div style="width: 28px; height: 28px; background: var(--bg-tertiary); border: 2px solid var(--border-color); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 5v14M19 12l-7 7-7-7"/>
                        </svg>
                    </div>
                </div>
                <div class="form-group">
                    <label>To Network</label>
                    <select id="bridgeToNetwork" class="form-control">
                        <option value="8453">Base</option>
                        <option value="42161">Arbitrum</option>
                        <option value="10">Optimism</option>
                        <option value="137">Polygon</option>
                        <option value="56">BNB Chain</option>
                        <option value="43114">Avalanche</option>
                        <option value="1">Ethereum</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <div style="position: relative;">
                        <input type="number" id="bridgeAmount" class="form-control" placeholder="0.0" step="0.000001" style="padding-right: 60px;">
                        <button id="bridgeMaxBtn" class="btn btn-secondary" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); padding: 4px 8px; font-size: 11px; height: auto;">Max</button>
                    </div>
                    <small style="color: var(--text-muted); font-size: 11px; margin-top: 4px; display: block;">Minimum: 0.01 ETH</small>
                </div>
                <div id="bridgeQuote" style="background: var(--bg-input); padding: 12px; border-radius: 6px; font-size: 12px; margin-top: 12px; display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                        <span style="color: var(--text-muted);">Estimated Time:</span>
                        <span id="bridgeTime" style="color: var(--text-primary);">~5 mins</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                        <span style="color: var(--text-muted);">Bridge Fee:</span>
                        <span id="bridgeFee" style="color: var(--text-primary);">0.001 ETH</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">You will receive:</span>
                        <span id="bridgeReceive" style="color: var(--text-primary); font-weight: 600;">0.099 ETH</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="bridgeModal">Cancel</button>
                <button id="getBridgeQuoteBtn" class="btn btn-secondary">Get Quote</button>
                <button id="confirmBridgeBtn" class="btn btn-orange" style="display: none;">Bridge</button>
            </div>
        </div>
    </div>


    <!-- Unified Swap/Bridge Modal -->
    <div id="swapModal" class="modal">
        <div class="modal-content swap-modal-content">
            <div class="modal-header">
                <h2 id="swapModalTitle">Swap</h2>
                <button class="modal-close" data-modal="swapModal">×</button>
            </div>
            
            <div class="modal-body" style="padding: 12px 16px;">
                <!-- ========== YOU PAY CARD ========== -->
                <div class="swap-card">
                    <div class="swap-card-header">
                        <span class="swap-card-label">You Pay</span>
                        <div class="swap-balance-row">
                            <span class="swap-card-balance" id="swapFromBalance">Balance: 0</span>
                            <button id="swapMaxBtn" class="swap-max-btn-small">Max</button>
                        </div>
                    </div>
                    
                    <div class="swap-card-content">
                        <div class="swap-card-left">
                            <!-- Network Selector -->
                            <button class="swap-network-btn" id="swapFromNetworkBtn">
                                <img id="swapFromNetworkIcon" src="https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png" alt="">
                                <span id="swapFromNetworkName">Ethereum</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                            </button>
                            <input type="hidden" id="swapFromNetwork" value="1">
                            
                            <!-- Token Selector -->
                            <button class="swap-token-btn" id="swapFromSelector">
                                <img id="swapFromIcon" src="https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png" alt="">
                                <span id="swapFromSymbol">ETH</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                            </button>
                            <input type="hidden" id="swapFromToken" value="ETH">
                        </div>
                        
                        <div class="swap-card-right">
                            <input type="number" id="swapFromAmount" class="swap-amount-input" placeholder="0" step="any">
                            <div class="swap-card-usd" id="swapFromValue">≈ $0.00</div>
                        </div>
                    </div>
                </div>
                
                <!-- Direction Button -->
                <div class="swap-direction-wrapper">
                    <button id="swapDirectionBtn" class="swap-direction-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M7 16V4M7 4L3 8M7 4L11 8M17 8V20M17 20L21 16M17 20L13 16"/>
                        </svg>
                    </button>
                </div>
                
                <!-- ========== YOU RECEIVE CARD ========== -->
                <div class="swap-card">
                    <div class="swap-card-header">
                        <span class="swap-card-label">You Receive</span>
                        <span class="swap-card-balance" id="swapToBalance">Balance: 0</span>
                    </div>
                    
                    <div class="swap-card-content">
                        <div class="swap-card-left">
                            <!-- Network Selector -->
                            <button class="swap-network-btn" id="swapToNetworkBtn">
                                <img id="swapToNetworkIcon" src="https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png" alt="">
                                <span id="swapToNetworkName">Ethereum</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                            </button>
                            <input type="hidden" id="swapToNetwork" value="1">
                            
                            <!-- Token Selector -->
                            <button class="swap-token-btn" id="swapToSelector">
                                <img id="swapToIcon" src="https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48/logo.png" alt="">
                                <span id="swapToSymbol">USDC</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                            </button>
                            <input type="hidden" id="swapToToken" value="USDC">
                        </div>
                        
                        <div class="swap-card-right">
                            <input type="number" id="swapToAmount" class="swap-amount-input" placeholder="0" readonly>
                            <div class="swap-card-usd" id="swapToValue">≈ $0.00</div>
                        </div>
                    </div>
                </div>
                
                <!-- Mode Indicator (Swap vs Bridge) -->
                <div id="swapModeIndicator" class="swap-mode-indicator" style="display: none;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4M12 8h.01"/>
                    </svg>
                    <span id="swapModeText">Cross-chain bridge</span>
                </div>
                
                <!-- Quote Info -->
                <!-- Unified Transaction Preview (Quote + Simulation) -->
                <div id="swapSimulationPreview" class="simulation-preview" style="display: none;">
                    <!-- Header: Provider + Confidence -->
                    <div class="simulation-header">
                        <div class="simulation-provider">
                            <img id="simProviderIcon" class="sim-provider-logo" src="" alt="" style="display: none;">
                            <span id="simProviderName" class="sim-provider-name">Best Route</span>
                        </div>
                        <span id="simulationConfidence" class="simulation-confidence">95%</span>
                    </div>
                    
                    <!-- All details in unified rows -->
                    <div class="simulation-details">
                        <!-- Balance changes (dynamic) -->
                        <div id="simulationBalanceChanges">
                            <!-- You Pay, You Receive, Gas Fee rows inserted here -->
                        </div>
                        
                        <!-- Divider -->
                        <div class="sim-divider"></div>
                        
                        <!-- Quote details -->
                        <div class="sim-detail-row" id="simRouteRow" style="display: none;">
                            <span>Route</span>
                            <span id="simRoute" class="sim-route">-</span>
                        </div>
                        <div class="sim-detail-row">
                            <span>Rate</span>
                            <span id="simRate">-</span>
                        </div>
                        <div class="sim-detail-row" id="simEstTimeRow" style="display: none;">
                            <span>Est. Time</span>
                            <span id="simEstTime">-</span>
                        </div>
                        <div class="sim-detail-row">
                            <span>Price Impact</span>
                            <span id="simPriceImpact">-</span>
                        </div>
                        <div class="sim-detail-row">
                            <span>Slippage</span>
                            <span id="simSlippage">-</span>
                        </div>
                        <div class="sim-detail-row" id="simMevRow">
                            <span>MEV Protection</span>
                            <span id="simMevProtection">-</span>
                        </div>
                        <div class="sim-detail-row" id="simBridgeFeeRow" style="display: none;">
                            <span>Bridge Fee</span>
                            <span id="simBridgeFee">-</span>
                        </div>
                        <div class="sim-detail-row">
                            <span>Min. Received</span>
                            <span id="simMinReceived">-</span>
                        </div>
                    </div>
                    
                    <!-- Warning -->
                    <div id="simulationBalanceWarning" class="simulation-warning" style="display: none;">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                            <line x1="12" y1="9" x2="12" y2="13"></line>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        <span id="simulationBalanceWarningText">Insufficient balance for gas</span>
                    </div>
                </div>
                
                <!-- Error Messages -->
                <div id="swapError" class="swap-error" style="display: none;">
                    <span id="swapErrorText"></span>
                </div>
                
                <!-- Loading State -->
                <div id="swapLoading" class="swap-loading" style="display: none;">
                    <div class="swap-loading-spinner"></div>
                    <span>Fetching best price...</span>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="swapModal">Cancel</button>
                <button id="swapApproveBtn" class="btn btn-orange" style="display: none;">Approve</button>
                <button id="swapConfirmBtn" class="btn btn-primary" disabled>Swap</button>
            </div>
        </div>
    </div>
    
    <!-- Token Approval Modal - Premium Design -->
    <div id="approvalModal" class="modal">
        <div class="modal-content approval-modal-content">
            <!-- Token Header with Gradient -->
            <div class="approval-token-header">
                <button class="modal-close" data-modal="approvalModal" style="position: absolute; top: 12px; right: 12px; background: rgba(0,0,0,0.1); border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center;">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
                <div class="approval-token-icon-wrapper">
                    <div id="approvalTokenIconContainer">
                        <div class="approval-token-icon-fallback" id="approvalTokenIcon">??</div>
                    </div>
                    <img id="approvalNetworkBadge" class="approval-network-badge" src="" alt="">
                </div>
                <div class="approval-token-name" id="approvalTokenSymbol">TOKEN</div>
                <div class="approval-token-network">
                    <span class="approval-token-network-dot"></span>
                    <span id="approvalNetworkName">Ethereum Network</span>
                </div>
            </div>
            
            <!-- Scrollable Content -->
            <div class="modal-body">
                <!-- Account & Balance Card -->
                <div class="approval-account-card">
                    <div class="approval-account-left">
                        <div class="approval-account-label">From</div>
                        <div class="approval-account-name" id="approvalAccountName">Account 1</div>
                        <div class="approval-account-address" id="approvalAccountAddress">0x0000...0000</div>
                    </div>
                    <div class="approval-account-right">
                        <div class="approval-balance-token" id="approvalBalanceToken">0.00 TOKEN</div>
                        <div class="approval-balance-usd" id="approvalBalanceUsd">$0.00</div>
                    </div>
                </div>
                
                <!-- Spender Card -->
                <div class="approval-spender-card">
                    <div class="approval-spender-label">Approve spending to</div>
                    <div class="approval-spender-info">
                        <div class="approval-spender-icon">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                            </svg>
                        </div>
                        <div class="approval-spender-details">
                            <div class="approval-spender-name" id="approvalSpenderName">DEX Aggregator</div>
                            <div class="approval-spender-address" id="approvalSpenderAddress" title="">0x0000...0000</div>
                        </div>
                    </div>
                </div>
                
                <!-- Risk Warning -->
                <div class="approval-risk-warning" id="approvalRiskWarning">
                    <div class="approval-risk-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                            <line x1="12" y1="9" x2="12" y2="13"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                    </div>
                    <div class="approval-risk-text">
                        This allows <strong id="riskSpenderName">DEX</strong> to spend your tokens. Only approve contracts you trust.
                    </div>
                </div>
                
                <!-- Spending Limit -->
                <div class="approval-section">
                    <div class="approval-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 6v6l4 2"/>
                        </svg>
                        Spending Limit
                    </div>
                    <div class="approval-limit-buttons">
                        <button class="approval-limit-btn" data-percent="exact">Exact Amount</button>
                        <button class="approval-limit-btn active" data-percent="unlimited">Unlimited</button>
                    </div>
                    <div class="approval-info-text" id="approvalLimitText">Unlimited approval for future transactions</div>
                </div>
                
                <!-- Gas Speed -->
                <div class="approval-section">
                    <div class="approval-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                        </svg>
                        Transaction Speed
                    </div>
                    <div class="approval-gas-buttons">
                        <button class="approval-gas-btn" data-speed="slow">
                            <span>Slow</span>
                            <span class="approval-gas-multiplier">0.85×</span>
                        </button>
                        <button class="approval-gas-btn active" data-speed="market">
                            <span>Standard</span>
                            <span class="approval-gas-multiplier">1.0×</span>
                        </button>
                        <button class="approval-gas-btn" data-speed="aggressive">
                            <span>Fast</span>
                            <span class="approval-gas-multiplier">1.3×</span>
                        </button>
                    </div>
                    <div class="approval-info-text" id="approvalGasEstimate">Estimated fee: ~$0.00</div>
                </div>
            </div>
            
            <!-- Action Buttons (sticky at bottom) -->
            <div class="approval-actions">
                <button id="approvalModalRejectBtn" class="approval-reject-btn">Reject</button>
                <button id="approvalModalApproveBtn" class="approval-confirm-btn">Approve</button>
            </div>
        </div>
    </div>
    
    <!-- Network Picker Modal (Fullscreen) -->
    <div id="networkPickerModal" class="token-picker-modal" style="display: none;">
        <div class="token-picker-modal-content">
            <div class="token-picker-modal-header">
                <h3>Select Network</h3>
                <button id="networkPickerClose" class="modal-close-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="token-picker-modal-section flex-grow" style="padding-top: 8px;">
                <div class="token-picker-token-list" id="networkPickerList"></div>
            </div>
        </div>
    </div>

    <!-- Connected Sites Modal -->
    <div id="connectedSitesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Connected dApps</h2>
                <button class="modal-close" data-modal="connectedSitesModal">×</button>
            </div>
            <div class="modal-body">
                <div id="connectedSitesList">
                    <!-- Sites will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Network Selection Modal -->
    <div id="networkModal" class="modal fullscreen-modal">
        <div class="fullscreen-modal-content">
            <div class="fullscreen-modal-header">
                <h2>Select Network</h2>
                <div class="network-header-actions">
                    <button class="network-testnet-btn" id="showTestnetsToggle" title="Show test networks">
                        Testnet
                    </button>
                    <button class="network-search-toggle" id="networkSearchToggle" title="Search">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="M21 21l-4.35-4.35"/>
                        </svg>
                    </button>
                    <button class="modal-close-btn" id="networkModalClose">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="network-search-container hidden" id="networkSearchContainer">
                <input type="text" id="networkSearchInput" class="network-search-input" placeholder="Search networks...">
                <button class="network-search-clear" id="networkSearchClear">×</button>
            </div>
            <div class="network-list" id="networkList">
                <!-- Networks will be populated here -->
            </div>
        </div>
    </div>

    <!-- Manage Networks Modal -->
    <div id="manageNetworksModal" class="modal fullscreen-modal">
        <div class="fullscreen-modal-content">
            <div class="fullscreen-modal-header">
                <h2>Manage Networks</h2>
                <button class="modal-close-btn" id="manageNetworksClose">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="manage-networks-info">
                <span id="manageNetworksCount">7 of 7 networks enabled</span>
                <div class="manage-networks-actions">
                    <button id="enableAllNetworks" class="btn-text">Enable All</button>
                    <span style="color: var(--text-muted);">|</span>
                    <button id="disableAllNetworks" class="btn-text">Disable All</button>
                </div>
            </div>
            <div class="manage-networks-list" id="manageNetworksList">
                <!-- Networks with toggles will be populated here -->
            </div>
        </div>
    </div>
    <div id="accountModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="selectAccount">Select Account</h2>
                <button class="modal-close" data-modal="accountModal">×</button>
            </div>
            <div class="modal-body">
                <div id="accountList" style="display: flex; flex-direction: column; gap: 8px;">
                    <!-- Accounts will be loaded here -->
                </div>
                <button id="addAccountBtn" class="btn btn-secondary" style="width: 100%; margin-top: 12px;" data-i18n="addAccount">
                    Add Account
                </button>
                
                <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 8px;">
                    <button id="lockWalletBtn" class="btn btn-secondary" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px;" data-i18n="lockWallet">
                        Lock Wallet
                    </button>
                    <a href="/cdn-cgi/l/email-protection#a9dadcd9d9c6dbdde9cfc6dbcecc84ccddc187c0c6" style="display: block; text-align: center; color: var(--text-muted); font-size: 12px; text-decoration: none; padding: 8px;" data-i18n="contactSupport">
                        Contact Support
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Rename Account Modal -->
    <div id="renameAccountModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="renameAccount">Rename Account</h2>
                <button class="modal-close" data-modal="renameAccountModal">×</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="accountName">Account Name</label>
                    <input type="text" id="renameAccountInput" class="form-control" data-i18n-placeholder="enterNewName" maxlength="20">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="renameAccountModal" data-i18n="cancel">Cancel</button>
                <button id="confirmRenameBtn" class="btn btn-primary" data-i18n="save">Save</button>
            </div>
        </div>
    </div>

    <!-- Add Token Modal -->
    <div id="addTokenModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="addToken">Add Token</h2>
                <button class="modal-close" data-modal="addTokenModal">×</button>
            </div>
            <div class="modal-body">
                <div class="tabs" style="margin-bottom: 16px;">
                    <button class="tab active" data-token-tab="popular" data-i18n="popular">Popular</button>
                    <button class="tab" data-token-tab="custom" data-i18n="custom">Custom</button>
                </div>

                <div id="popularTokenTab" class="token-tab-content active">
                    <!-- Search input -->
                    <div style="margin-bottom: 12px;">
                        <input type="text" id="tokenSearchInput" class="form-control" placeholder="Search tokens..." style="padding: 10px 12px; font-size: 13px;">
                    </div>
                    <div id="popularTokenList" style="display: flex; flex-direction: column; gap: 8px; max-height: 280px; overflow-y: auto;">
                        <!-- Popular tokens will be loaded here -->
                    </div>
                </div>

                <div id="customTokenTab" class="token-tab-content" style="display: none;">
                    <div class="form-group">
                        <label data-i18n="tokenContractAddress">Token Contract Address</label>
                        <input type="text" id="tokenAddress" class="form-control" placeholder="0x...">
                    </div>
                    <div class="form-group">
                        <label data-i18n="tokenSymbol">Token Symbol</label>
                        <input type="text" id="tokenSymbol" class="form-control" placeholder="e.g., USDT" maxlength="10">
                    </div>
                    <div class="form-group">
                        <label data-i18n="decimals">Decimals</label>
                        <input type="number" id="tokenDecimals" class="form-control" placeholder="18" min="0" max="18" value="18">
                    </div>
                    <button id="confirmAddCustomTokenBtn" class="btn btn-primary" style="width: 100%; margin-top: 12px;" data-i18n="addCustomToken">Add Custom Token</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Token Details Screen -->
    <div id="tokenDetailsScreen" class="screen" style="display: none;">
        <div class="wallet-header" style="display: flex; align-items: center; justify-content: space-between;">
            <button id="tokenDetailsBack" style="background: none; border: none; color: var(--text-primary); cursor: pointer; display: flex; align-items: center; gap: 4px; font-size: 14px; padding: 8px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                <span data-i18n="back">Back</span>
            </button>
            <div style="display: flex; align-items: center; gap: 8px;">
                <img id="tokenDetailsNetworkIcon" src="../assets/token-icons/eth.svg" style="width: 20px; height: 20px;">
                <span id="tokenDetailsNetworkName" style="font-size: 12px; color: var(--text-muted);">Ethereum</span>
            </div>
        </div>
        
        <div style="padding: 16px; overflow-y: auto; max-height: calc(100vh - 120px);">
            <!-- Token Header -->
            <div style="text-align: center; margin-bottom: 20px;">
                <img id="tokenDetailsIcon" src="../assets/token-icons/eth.svg" style="width: 56px; height: 56px; border-radius: 50%; margin-bottom: 12px;">
                <h2 id="tokenDetailsName" style="margin: 0 0 4px 0; font-size: 20px; color: var(--text-primary);">Ethereum</h2>
                <div id="tokenDetailsPrice" style="font-size: 28px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">$0.00</div>
                <div id="tokenDetailsPriceChange" style="font-size: 14px; color: var(--success);">+0.00% (24h)</div>
            </div>
            
            <!-- Price Chart -->
            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <span style="font-size: 13px; font-weight: 600; color: var(--text-primary); display: flex; align-items: center; gap: 6px;"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>Price Chart</span>
                    <div id="chartTimeButtons" style="display: flex; gap: 4px;">
                        <button class="chart-time-btn" data-days="1" style="padding: 4px 8px; font-size: 10px; border-radius: 4px; border: 1px solid var(--border-color); background: var(--bg-input); color: var(--text-muted); cursor: pointer;">1D</button>
                        <button class="chart-time-btn active" data-days="7" style="padding: 4px 8px; font-size: 10px; border-radius: 4px; border: 1px solid var(--accent-blue); background: var(--accent-blue); color: white; cursor: pointer;">7D</button>
                        <button class="chart-time-btn" data-days="30" style="padding: 4px 8px; font-size: 10px; border-radius: 4px; border: 1px solid var(--border-color); background: var(--bg-input); color: var(--text-muted); cursor: pointer;">1M</button>
                        <button class="chart-time-btn" data-days="365" style="padding: 4px 8px; font-size: 10px; border-radius: 4px; border: 1px solid var(--border-color); background: var(--bg-input); color: var(--text-muted); cursor: pointer;">1Y</button>
                    </div>
                </div>
                <div id="priceChartContainer" style="height: 120px; position: relative;">
                    <canvas id="priceChart" style="width: 100%; height: 100%;"></canvas>
                    <div id="chartLoading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--text-muted); font-size: 12px;">Loading chart...</div>
                </div>
            </div>
            
            <!-- Your Balance -->
            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;" data-i18n="yourBalance">Your Balance</div>
                <div id="tokenDetailsBalance" style="font-size: 20px; font-weight: 600; color: var(--text-primary);">0.0000</div>
                <div id="tokenDetailsBalanceUSD" style="font-size: 14px; color: var(--text-muted);">≈ $0.00 USD</div>
            </div>
            
            <!-- Market Data -->
            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                <div style="font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;" data-i18n="marketData">Market Data</div>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 12px; color: var(--text-muted);" data-i18n="marketCap">Market Cap</span>
                        <span id="tokenDetailsMarketCap" style="font-size: 12px; color: var(--text-primary);">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 12px; color: var(--text-muted);" data-i18n="volume24h">24h Volume</span>
                        <span id="tokenDetailsVolume" style="font-size: 12px; color: var(--text-primary);">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 12px; color: var(--text-muted);" data-i18n="high24h">24h High</span>
                        <span id="tokenDetailsHigh" style="font-size: 12px; color: var(--text-primary);">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 12px; color: var(--text-muted);" data-i18n="low24h">24h Low</span>
                        <span id="tokenDetailsLow" style="font-size: 12px; color: var(--text-primary);">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 12px; color: var(--text-muted);" data-i18n="allTimeHigh">All-Time High</span>
                        <span id="tokenDetailsATH" style="font-size: 12px; color: var(--text-primary);">-</span>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div style="display: flex; gap: 12px; margin-bottom: 12px;">
                <button id="tokenDetailsSendBtn" class="btn btn-primary" style="flex: 1;" data-i18n="send">
                    Send
                </button>
                <button id="tokenDetailsReceiveBtn" class="btn btn-secondary" style="flex: 1;" data-i18n="receive">
                    Receive
                </button>
            </div>
            
            <!-- Remove Token Button (only for non-native tokens) -->
            <button id="tokenDetailsRemoveBtn" class="btn" style="width: 100%; background: transparent; border: 1px solid var(--error); color: var(--error); display: none;" data-i18n="removeToken">
                Remove Token
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal modal-fullscreen">
        <div class="modal-content">
            <!-- Main Settings Screen -->
            <div id="settingsMain">
                <div class="modal-header">
                    <h2 data-i18n="settings">Settings</h2>
                    <button class="modal-close" data-modal="settingsModal">×</button>
                </div>
                <div class="modal-body" style="padding: 0;">
                    <!-- Interface Mode Section (FIRST) -->
                    <div class="settings-section" style="border-bottom: 2px solid var(--border-color);">
                        <div style="padding: 16px; background: var(--bg-secondary);">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                        <rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/>
                                    </svg>
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px;">Interface Mode</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Choose your wallet experience</div>
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                                <div class="mode-card" data-mode="beginner">
                                    <div class="mode-icon">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="2">
                                            <path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                                        </svg>
                                    </div>
                                    <div class="mode-name">Beginner</div>
                                    <div class="mode-desc">Simple & Easy</div>
                                </div>
                                <div class="mode-card mode-card-active" data-mode="advanced">
                                    <div class="mode-icon">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="2">
                                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                                        </svg>
                                    </div>
                                    <div class="mode-name">Advanced</div>
                                    <div class="mode-desc">Full Control</div>
                                </div>
                                <div class="mode-card" data-mode="stealth">
                                    <div class="mode-icon">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#F97316" stroke-width="2">
                                            <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2z"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/>
                                        </svg>
                                    </div>
                                    <div class="mode-name">Stealth</div>
                                    <div class="mode-desc">Max Privacy</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Section -->
                    <div class="settings-section">
                        <div class="settings-section-header" data-section="security">
                            <span class="settings-section-title" data-i18n="security">Security</span>
                            <span class="settings-section-arrow">▶</span>
                        </div>
                        <div class="settings-section-content" id="sectionSecurity" style="display: none;">
                            <div id="settingsChangePassword" class="settings-item">
                                <span data-i18n="changePassword">Change Password</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="autoLockTimeout">Auto-lock Timeout</span>
                                <select id="settingsAutoLock" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 4px 8px; color: var(--text-primary); font-size: 12px;">
                                    <option value="1">1 min</option>
                                    <option value="5" selected>5 min</option>
                                    <option value="15">15 min</option>
                                    <option value="30">30 min</option>
                                    <option value="0">Never</option>
                                </select>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="hideBalances">Hide Balances</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="settingsHideBalances">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <div id="settingsExportSeed" class="settings-item">
                                <span data-i18n="exportSeedPhrase">Export Seed Phrase</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                            
                            <div id="settingsExportKey" class="settings-item">
                                <span data-i18n="exportPrivateKey">Export Private Key</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>

                            <div class="settings-item" style="justify-content: space-between; border-top: 1px solid var(--border-color); padding-top: 12px; margin-top: 8px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="2">
                                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                                    </svg>
                                    <div>
                                        <div>FSS Protection</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Fraud & Scam Shield</div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="fssToggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div id="fssStats" class="settings-item" style="flex-direction: column; align-items: flex-start; background: var(--bg-secondary); border-radius: 8px; padding: 12px; margin-top: 8px;">
                                <div style="font-size: 13px; font-weight: 600; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="2">
                                        <path d="M9 11l3 3L22 4"/>
                                        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                                    </svg>
                                    FSS Statistics
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%;">
                                    <div style="text-align: center; padding: 8px; background: var(--bg-primary); border-radius: 6px;">
                                        <div style="font-size: 20px; font-weight: 700; color: var(--primary-color);" id="fssBlockedCount">0</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Scams Blocked</div>
                                    </div>
                                    <div style="text-align: center; padding: 8px; background: var(--bg-primary); border-radius: 6px;">
                                        <div style="font-size: 20px; font-weight: 700; color: #10B981;" id="fssSavedAmount">$0</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Funds Protected</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Network Section -->
                    <div class="settings-section">
                        <div class="settings-section-header" data-section="network">
                            <span class="settings-section-title" data-i18n="network">Network</span>
                            <span class="settings-section-arrow">▶</span>
                        </div>
                        <div class="settings-section-content" id="sectionNetwork" style="display: none;">
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="defaultNetwork">Default Network</span>
                                <select id="settingsDefaultNetwork" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 4px 8px; color: var(--text-primary); font-size: 12px;">
                                    <option value="1">Ethereum</option>
                                    <option value="8453">Base</option>
                                    <option value="42161">Arbitrum</option>
                                    <option value="137">Polygon</option>
                                </select>
                            </div>
                            
                            <div id="settingsManageNetworks" class="settings-item">
                                <div style="display: flex; flex-direction: column;">
                                    <span>Manage Networks</span>
                                    <span id="enabledNetworksCount" style="font-size: 11px; color: var(--text-muted);">7 of 7 enabled</span>
                                </div>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="gasPreference">Gas Preference</span>
                                <select id="settingsGasPreference" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 4px 8px; color: var(--text-primary); font-size: 12px;">
                                    <option value="slow">Slow (0.85x)</option>
                                    <option value="market" selected>Market (1.0x)</option>
                                    <option value="aggressive">Fast (1.3x)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Help & Support Section -->
                    <div class="settings-section">
                        <div class="settings-section-header" data-section="help">
                            <span class="settings-section-title">Help & Support</span>
                            <span class="settings-section-arrow">▶</span>
                        </div>
                        <div class="settings-section-content" id="sectionHelp" style="display: none;">
                            <div id="openAISupportBtn" class="settings-item" onclick="openAISupport()">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="2">
                                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                                    </svg>
                                    <div>
                                        <div>AI Support</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Get instant help from AI</div>
                                    </div>
                                </div>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                            <div class="settings-item">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"/>
                                        <line x1="12" y1="16" x2="12" y2="12"/>
                                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                                    </svg>
                                    <span>Documentation</span>
                                </div>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                        </div>
                    </div>

                    <!-- Display Section -->
                    <div class="settings-section">
                        <div class="settings-section-header" data-section="display">
                            <span class="settings-section-title" data-i18n="display">Display</span>
                            <span class="settings-section-arrow">▶</span>
                        </div>
                        <div class="settings-section-content" id="sectionDisplay" style="display: none;">
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="theme">Theme</span>
                                <select id="settingsTheme" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 4px 8px; color: var(--text-primary); font-size: 12px;">
                                    <option value="system" data-i18n-option="themeSystem">System</option>
                                    <option value="dark" data-i18n-option="themeDark">Dark</option>
                                    <option value="light" data-i18n-option="themeLight">Light</option>
                                </select>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="language">Language</span>
                                <select id="settingsLanguage" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 4px 8px; color: var(--text-primary); font-size: 12px;">
                                    <option value="en">English</option>
                                    <option value="fr">Français</option>
                                    <option value="de">Deutsch</option>
                                    <option value="es">Español</option>
                                    <option value="pt">Português</option>
                                    <option value="uk">Українська</option>
                                    <option value="ru">Русский</option>
                                    <option value="zh">中文</option>
                                </select>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="currency">Currency</span>
                                <select id="settingsCurrency" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 4px 8px; color: var(--text-primary); font-size: 12px;">
                                    <option value="USD">USD ($)</option>
                                    <option value="EUR">EUR (€)</option>
                                    <option value="GBP">GBP (£)</option>
                                    <option value="UAH">UAH (₴)</option>
                                    <option value="JPY">JPY (¥)</option>
                                    <option value="BTC">BTC (₿)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Advanced Section -->
                    <div class="settings-section">
                        <div class="settings-section-header" data-section="advanced">
                            <span class="settings-section-title" data-i18n="advanced">Advanced</span>
                            <span class="settings-section-arrow">▶</span>
                        </div>
                        <div class="settings-section-content" id="sectionAdvanced" style="display: none;">
                            <div id="settingsClearCache" class="settings-item">
                                <span data-i18n="clearCache">Clear Cache</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                            
                            <div id="settingsConnectedSites" class="settings-item">
                                <span data-i18n="connectedSites">Connected Sites</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                            
                            <div id="settingsResetWallet" class="settings-item" style="color: var(--error);">
                                <span data-i18n="resetWallet">Reset Wallet</span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- About Section -->
                    <div class="settings-section">
                        <div class="settings-section-header" data-section="about">
                            <span class="settings-section-title" data-i18n="about">About</span>
                            <span class="settings-section-arrow">▶</span>
                        </div>
                        <div class="settings-section-content" id="sectionAbout" style="display: none;">
                            <div class="settings-item" style="justify-content: space-between; cursor: default;">
                                <span data-i18n="version">Version</span>
                                <span style="color: var(--text-muted);">v4.8.5</span>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between; cursor: default;">
                                <span data-i18n="builtBy">Built by</span>
                                <span style="color: var(--accent-blue);">ForgeETH</span>
                            </div>
                            
                            <div class="settings-item" style="justify-content: space-between;">
                                <span data-i18n="contactSupport">Contact Support</span>
                                <a href="/cdn-cgi/l/email-protection#097a7c7979667b7d496f667b6e6c246c7d61276066" style="color: var(--accent-blue); text-decoration: none;"><span class="__cf_email__" data-cfemail="e3909693938c9197a3858c918486ce86978bcd8a8c">[email&#160;protected]</span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Change Password Screen -->
            <div id="settingsPasswordScreen" style="display: none;">
                <div class="modal-header">
                    <button id="settingsPasswordBack" style="background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0; margin-right: 8px; display: flex; align-items: center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2 data-i18n="changePassword">Change Password</h2>
                    <button class="modal-close" data-modal="settingsModal">×</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label" data-i18n="currentPassword">Current Password</label>
                        <input type="password" id="currentPasswordInput" class="form-control" data-i18n-placeholder="enterPassword">
                        <div id="currentPasswordError" style="color: var(--error); font-size: 11px; margin-top: 4px; display: none;"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" data-i18n="newPassword">New Password</label>
                        <input type="password" id="newPasswordInput" class="form-control" data-i18n-placeholder="enterPassword">
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 4px;" data-i18n="passwordMinLength">Minimum 8 characters</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" data-i18n="confirmPassword">Confirm New Password</label>
                        <input type="password" id="confirmPasswordInput" class="form-control" data-i18n-placeholder="confirmPassword">
                        <div id="confirmPasswordError" style="color: var(--error); font-size: 11px; margin-top: 4px; display: none;"></div>
                    </div>
                    
                    <button id="updatePasswordBtn" class="btn btn-primary" style="width: 100%; margin-top: 16px;" data-i18n="update">Update Password</button>
                </div>
            </div>
            
            <!-- Export Seed Phrase Screen -->
            <div id="settingsSeedScreen" style="display: none;">
                <div class="modal-header">
                    <button id="settingsSeedBack" style="background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0; margin-right: 8px; display: flex; align-items: center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2 data-i18n="seedPhrase">Seed Phrase</h2>
                    <button class="modal-close" data-modal="settingsModal">×</button>
                </div>
                <div class="modal-body">
                    <div id="settingsSeedPrompt">
                        <div style="background: rgba(234, 179, 8, 0.1); border: 1px solid rgba(234, 179, 8, 0.3); border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                            <div style="color: #eab308; font-weight: 600; font-size: 12px; margin-bottom: 4px; display: flex; align-items: center; gap: 4px;"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg><span data-i18n="warning">Warning</span></div>
                            <div style="color: var(--text-muted); font-size: 11px; line-height: 1.4;" data-i18n="seedPhraseWarning">Never share your seed phrase! Anyone with these words can access all your funds.</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Enter Password to Continue</label>
                            <input type="password" id="settingsSeedPasswordInput" class="form-control" data-i18n-placeholder="enterPassword">
                            <div id="settingsSeedPasswordError" style="color: var(--error); font-size: 11px; margin-top: 4px; display: none;"></div>
                        </div>
                        
                        <button id="settingsShowSeedBtn" class="btn btn-primary" style="width: 100%;" data-i18n="showSeedPhrase">Show Seed Phrase</button>
                    </div>
                    
                    <div id="settingsSeedDisplay" style="display: none;">
                        <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                            <div id="settingsSeedWords" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;"></div>
                        </div>
                        
                        <button id="settingsCopySeedBtn" class="btn btn-secondary" style="width: 100%;" data-i18n="copyToClipboard"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>Copy to Clipboard</button>
                    </div>
                </div>
            </div>
            
            <!-- Export Private Key Screen -->
            <div id="settingsKeyScreen" style="display: none;">
                <div class="modal-header">
                    <button id="settingsKeyBack" style="background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0; margin-right: 8px; display: flex; align-items: center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2 data-i18n="privateKey">Private Key</h2>
                    <button class="modal-close" data-modal="settingsModal">×</button>
                </div>
                <div class="modal-body">
                    <div id="keyPasswordPrompt">
                        <div style="background: rgba(234, 179, 8, 0.1); border: 1px solid rgba(234, 179, 8, 0.3); border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                            <div style="color: #eab308; font-weight: 600; font-size: 12px; margin-bottom: 4px; display: flex; align-items: center; gap: 4px;"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg><span data-i18n="warning">Warning</span></div>
                            <div style="color: var(--text-muted); font-size: 11px; line-height: 1.4;" data-i18n="privateKeyWarning">Never share your private key! Anyone with it can steal your funds from this account.</div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" data-i18n="enterPassword">Enter Password to Continue</label>
                            <input type="password" id="keyPasswordInput" class="form-control" data-i18n-placeholder="enterPassword">
                            <div id="keyPasswordError" style="color: var(--error); font-size: 11px; margin-top: 4px; display: none;"></div>
                        </div>
                        
                        <button id="showKeyBtn" class="btn btn-primary" style="width: 100%;" data-i18n="showPrivateKey">Show Private Key</button>
                    </div>
                    
                    <div id="privateKeyDisplay" style="display: none;">
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;"><span data-i18n="account">Account</span>: <span id="keyAccountName" style="color: var(--text-primary);">Account 1</span></div>
                        </div>
                        
                        <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 16px; position: relative;">
                            <div id="privateKeyText" style="font-family: monospace; font-size: 11px; word-break: break-all; color: var(--text-primary); filter: blur(4px); transition: filter 0.2s;"></div>
                            <button id="toggleKeyVisibility" style="position: absolute; top: 8px; right: 8px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 4px; padding: 4px 8px; font-size: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                        
                        <button id="copyKeyBtn" class="btn btn-secondary" style="width: 100%;" data-i18n="copyToClipboard"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>Copy to Clipboard</button>
                    </div>
                </div>
            </div>
            
            <!-- Reset Wallet Confirmation -->
            <div id="settingsResetScreen" style="display: none;">
                <div class="modal-header">
                    <button id="settingsResetBack" style="background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0; margin-right: 8px; display: flex; align-items: center;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2 data-i18n="resetWallet">Reset Wallet</h2>
                    <button class="modal-close" data-modal="settingsModal">×</button>
                </div>
                <div class="modal-body">
                    <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 16px; margin-bottom: 16px; text-align: center;">
                        <div style="margin-bottom: 8px;">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--error)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                        </div>
                        <div style="color: var(--error); font-weight: 600; font-size: 14px; margin-bottom: 8px;" data-i18n="cannotBeUndone">This action cannot be undone!</div>
                        <div style="color: var(--text-muted); font-size: 12px; line-height: 1.4;">All wallet data will be permanently deleted. Make sure you have backed up your seed phrase before proceeding.</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Type "RESET" to confirm</label>
                        <input type="text" id="resetConfirmInput" class="form-control" placeholder="RESET">
                    </div>
                    
                    <button id="confirmResetBtn" class="btn" style="width: 100%; background: var(--error); color: white;" disabled>Reset Wallet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Transaction Details Modal -->
    <div id="txDetailsModal" class="modal modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Transaction Details</h2>
                <button class="modal-close" data-modal="txDetailsModal">×</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div id="txDetailsContent">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>
    </div>

    <!-- API Client (must load before modules that use it) -->
    <script src="../utils/fortixApi.js"></script>
    
    <!-- Modules (order matters for dependencies!) -->
    <script src="modules/utils.js"></script>
    <script src="modules/tokens.js"></script>
    <script src="modules/gas.js"></script>
    <script src="modules/approval.js"></script>
    <script src="modules/session.js"></script>
    <script src="modules/balance-manager.js"></script>
    <script src="modules/networks.js"></script>
    <script src="modules/receive.js"></script>
    <script src="modules/token-picker.js"></script>
    <script src="modules/dapp-connection.js"></script>
    <script src="modules/transaction-history.js"></script>
    <script src="modules/network-picker.js"></script>
    <script src="modules/swap-bridge.js"></script>
    <script src="modules/token-details.js"></script>
    <script src="modules/settings.js"></script>
    <script src="modules/security.js"></script>
    
    <!-- Main Application -->
    <script src="popup.js"></script>
    
    <!-- Toast Container -->
    <div id="toastContainer" style="position: fixed; top: 16px; right: 16px; z-index: 10000; display: flex; flex-direction: column; gap: 8px;"></div>
    <!-- Token Picker Modal (Fullscreen) -->
    <div id="tokenPickerModal" class="token-picker-modal" style="display: none;">
        <div class="token-picker-modal-content">
            <div class="token-picker-modal-header">
                <h3>Select Token</h3>
                <button id="tokenPickerClose" class="modal-close-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="token-picker-modal-search">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
                <input type="text" id="tokenPickerSearch" placeholder="Search by name or symbol...">
            </div>
            <div class="token-picker-modal-section">
                <div class="token-picker-modal-section-title">Popular</div>
                <div class="token-picker-popular-grid" id="tokenPickerPopular"></div>
            </div>
            <div class="token-picker-modal-section flex-grow">
                <div class="token-picker-modal-section-title">All Tokens</div>
                <div class="token-picker-token-list" id="tokenPickerList"></div>
            </div>
        </div>
    </div>

    <!-- FSS Security Warning Modal -->
    <div id="securityWarningModal" class="modal" style="z-index: 10001;">
        <div class="modal-content" style="max-width: 420px; padding: 0; overflow: hidden;">
            <div id="securityWarningHeader" style="padding: 20px; background: linear-gradient(135deg, #ff4444 0%, #ff6b6b 100%); color: white;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                        <line x1="12" y1="9" x2="12" y2="13"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <div>
                        <h3 id="securityWarningTitle" style="margin: 0; font-size: 18px; font-weight: 600;">Security Alert</h3>
                        <p id="securityWarningRiskLevel" style="margin: 4px 0 0 0; font-size: 14px; opacity: 0.9;">CRITICAL RISK</p>
                    </div>
                </div>
            </div>
            <div style="padding: 20px;">
                <div id="securityWarningFlags" style="margin-bottom: 16px;">
                    <!-- Flags will be inserted here -->
                </div>
                <div id="securityWarningMessage" style="margin-bottom: 20px; padding: 12px; background: rgba(255,68,68,0.1); border-radius: 8px; font-size: 14px; color: var(--text-primary);">
                    This transaction shows signs of a scam. Proceeding may result in loss of funds.
                </div>
                <div style="display: flex; gap: 12px;">
                    <button id="securityWarningCancel" class="btn" style="flex: 1; background: var(--bg-secondary); color: var(--text-primary);">
                        Cancel Transaction
                    </button>
                    <button id="securityWarningProceed" class="btn btn-danger" style="flex: 1; display: none;">
                        Proceed Anyway
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Support Chat Modal -->
    <div id="aiSupportModal" class="modal" style="z-index: 10000;">
        <div class="modal-content" style="max-width: 500px; height: 600px; display: flex; flex-direction: column; padding: 0;">
            <div class="modal-header" style="padding: 16px 20px; border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                        </svg>
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600;">AI Support</h2>
                    </div>
                    <button class="close" onclick="closeAISupport()">&times;</button>
                </div>
            </div>
            <div id="aiChatMessages" style="flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px;">
                <div class="ai-message ai-bot">
                    <div class="ai-avatar">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"/>
                        </svg>
                    </div>
                    <div class="ai-content">
                        <p>Hi! I'm your AI assistant. I can help you with:</p>
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li>Understanding swaps and bridges</li>
                            <li>Explaining transaction errors</li>
                            <li>Security advice</li>
                            <li>General wallet questions</li>
                        </ul>
                        <p style="margin-top: 8px;">How can I help you today?</p>
                    </div>
                </div>
            </div>
            <div style="padding: 16px; border-top: 1px solid var(--border-color); flex-shrink: 0;">
                <div style="display: flex; gap: 8px;">
                    <input type="text" id="aiChatInput" placeholder="Ask me anything..." style="flex: 1; padding: 10px 14px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; background: var(--bg-primary); color: var(--text-primary);">
                    <button id="aiChatSend" class="btn btn-primary" style="padding: 10px 20px; white-space: nowrap;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"/>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                        </svg>
                    </button>
                </div>
                <div id="aiChatLoading" style="display: none; margin-to